<template>
	<div class="demo-table">
		<cl-table :ref="setRefs('table')" v-bind="table" :auto-height="false"> </cl-table>
	</div>

	<cl-form :ref="setRefs('form')"></cl-form>
</template>

<script lang="ts">
import { defineComponent, reactive } from "vue";
import { Table } from "@/types";
import Test2 from "./render/test2";
import { useRefs } from "@/hooks";

export default defineComponent({
	setup() {
		const { refs, setRefs }: any = useRefs();

		const table = reactive<Table>({
			props: {
				// defaultSort: {
				// 	prop: "createTime",
				// 	order: "descending"
				// }
			},

			columns: [
				{
					type: "selection",
					width: 60
				},
				{
					label: "姓名",
					prop: "name",
					minWidth: 120,
					sortable: true,
					component: Test2,
					hidden: false
				},
				{
					label: "存款",
					prop: "price",
					minWidth: 120,
					component: {
						name: "el-input-number"
					}
				},
				{
					label: "状态",
					prop: "status",
					minWidth: 120,
					dict: [
						{
							label: "启用",
							value: 1
						},
						{
							label: "禁用",
							value: 0,
							type: "danger"
						}
					]
				},
				{
					label: "创建时间",
					prop: "createTime",
					sortable: "desc",
					minWidth: 150
				},
				{
					label: "操作",
					type: "op",
					buttons: [
						"edit",
						"delete",
						{
							label: "管理",
							onClick({ scope }: any) {
								refs.value.form.open({
									items: [
										{
											label: "姓名",
											prop: "name",
											component: {
												name: "el-input"
											}
										}
									],
									form: {
										...scope.row
									}
								});
							}
						}
					]
				}
			]
		});

		return {
			refs,
			setRefs,
			table
		};
	}
});
</script>

<style lang="scss" scoped>
.demo-table {
	width: 100%;
}
</style>
